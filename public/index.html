<!DOCTYPE html>
<html>
<head>
  <meta charset="UTF-8">
  <title>Kahoot Clone</title>
  <link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@400;600&display=swap" rel="stylesheet">
    <style>
        body {
            font-family: 'Montserrat', sans-serif;
            margin: 0;
            padding: 20px;
            background-color: #46178f;
            color: white;
        }

        #joinSection, #quiz {
            max-width: 800px;
            margin: 0 auto;
            text-align: center;
        }

        h1 {
            font-size: 2.5em;
            text-align: center;
            margin-bottom: 30px;
        }

        #nameInput {
            padding: 15px;
            font-size: 1.2em;
            border: none;
            border-radius: 4px;
            margin-bottom: 20px;
            width: 80%;
            max-width: 300px;
        }

        #joinBtn {
            background-color: #26890c;
            color: white;
            border: none;
            padding: 15px 30px;
            font-size: 1.2em;
            border-radius: 4px;
            cursor: pointer;
            transition: background-color 0.3s;
        }

        #joinBtn:hover {
            background-color: #1e6b09;
        }

        .question {
            font-size: 1.5em;
            margin: 20px 0;
            padding: 20px;
            background-color: rgba(255, 255, 255, 0.1);
            border-radius: 8px;
        }

        #answerForm {
            margin-top: 20px;
        }

        #answerInput {
            padding: 15px;
            font-size: 1.2em;
            border: none;
            border-radius: 4px;
            margin-bottom: 20px;
            width: 80%;
            max-width: 300px;
        }

        #submitAnswer {
            background-color: #ff3355;
            color: white;
            border: none;
            padding: 15px 30px;
            font-size: 1.2em;
            border-radius: 4px;
            cursor: pointer;
            transition: background-color 0.3s;
        }

        #submitAnswer:hover {
            background-color: #e62e4c;
        }

        .waiting-message {
            font-size: 1.2em;
            margin: 20px 0;
            padding: 20px;
            background-color: rgba(255, 255, 255, 0.1);
            border-radius: 8px;
            animation: pulse 2s infinite;
        }

        @keyframes pulse {
            0% {
                transform: scale(1);
            }
            50% {
                transform: scale(1.05);
            }
            100% {
                transform: scale(1);
            }
        }

        /* Add some responsiveness */
        @media (max-width: 480px) {
            body {
                padding: 10px;
            }

            h1 {
                font-size: 2em;
            }

            #nameInput, #answerInput {
                width: 90%;
            }
        }
    </style>
</head>
<body>
    <div id="join">
    <h1>Join the Quiz</h1>
    <input type="text" id="nameInput" placeholder="Your Name">
    <button id="joinBtn">Join</button>
    </div>

    <div id="waiting" style="display: none;">
      <h2>Welcome to the Quiz!</h2>
      <p>Waiting for the quiz master to start the game...</p>
    </div>

  <div id="quiz" style="display: none;">
    <h2 class="question"></h2>
    <form id="answerForm">
      <input type="text" id="answerInput" placeholder="Your Answer">
      <button type="submit" id="submitAnswer">Submit</button>
    </form>
  </div>

  <div id="endGameSection" style="display: none;">
    <h1>Quiz Complete! ðŸŽ‰</h1>
    <p>Thanks for playing!</p>
  </div>

  <script src="/socket.io/socket.io.js"></script>
  <script>
    const socket = io();
    
    // Join
    document.getElementById('joinBtn').onclick = () => {
      const name = document.getElementById('nameInput').value.trim();
      if (name) {
        socket.emit('joinQuiz', name);
        document.getElementById('join').style.display = 'none';
        document.getElementById('waiting').style.display = 'block';
      }
    };

    // Show question
    socket.on('question', (data) => {
      document.getElementById('waiting').style.display = 'none';
      document.querySelector('#answerForm').style.display = 'block';
      document.querySelector('#answerForm').style.display = 'blo';
      console.log(data);
      const quizDiv = document.getElementById('quiz');
      quizDiv.style.display = 'block';
      quizDiv.querySelector('.question').textContent = data.question;
    });

    // Handle answer submission
    document.getElementById('answerForm').onsubmit = (e) => {
      e.preventDefault(); // Prevent page refresh
      const answer = document.getElementById('answerInput').value.trim();
      if (answer) {
        socket.emit('submitAnswer', answer);
        document.getElementById('answerInput').value = '';
        document.querySelector('.question').textContent = 'Answer submitted! Waiting for next question...';
        document.querySelector('#answerForm').style.display = 'none';
      }
    };

    let winners = [];
    socket.on('quizEnd', (scores) => {
      console.log('Quiz ended, received scores:', scores);
      document.getElementById('quiz').style.display = 'none';
      document.getElementById('endGameSection').style.display = 'block';
      winners = scores;
    });

    socket.on('revealWinner', (winnerData) => {
      const winnerElement = document.createElement('div');
      winnerElement.className = 'winner-entry';
      winnerElement.innerHTML = `
        <h3>${winnerData.place}${getOrdinalSuffix(winnerData.place)} Place</h3>
        <p>${winnerData.name} - ${winnerData.score} points</p>
      `;
      
      const winnersDisplay = document.getElementById('winnersDisplay');
      winnersDisplay.insertBefore(winnerElement, winnersDisplay.firstChild);
    });

    function getOrdinalSuffix(i) {
      const j = i % 10;
      const k = i % 100;
      if (j == 1 && k != 11) return "st";
      if (j == 2 && k != 12) return "nd";
      if (j == 3 && k != 13) return "rd";
      return "th";
    }
  </script>

</body>
</html>
